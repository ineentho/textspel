<form method="post" id="loginForm">
  <label for="username">Username:</label><br>
  <input type="text" name="username" id="username"><br>

  <label for="username">Password:</label><br>
  <input type="password" name="password" id="password"><br>

  <input type="submit" value="Login">
</form>

<script>
  document.querySelector('#loginForm').addEventListener('submit', e => {
    const username = document.querySelector('#username').value
    const password = document.querySelector('#password').value
  
    fetch('/api/user/login', {
      method: 'POST',
      headers: {
        'accept': 'application/json',
        'content-type': 'application/json' 
      },
      body: JSON.stringify({
        username, password
      })
    }).then(resp => resp.json()).then(json => {
      if (!json.success) {
        alert('Could not login:\n' + json.error)
      } else {
        localStorage.setItem('key', json.key)
        window.location = '/account.html'
      }
    })

    e.preventDefault()
  })
</script>
